{% extends "base.html" %}
{% block title %}
{{ config.extra.author }} - {{ section.title }}
{% endblock title %}
{% block content %}

<style>
    /* Style inputs with type="text", select elements and textareas */
    input[type=text], input[type=email], textarea {
        width: 100%; /* Full width */
        padding: 12px; /* Some padding */
        border: 1px solid #ccc; /* Gray border */
        border-radius: 4px; /* Rounded borders */
        box-sizing: border-box; /* Make sure that padding and width stays in place */
        margin-top: 10px; /* Add a top margin */
        margin-bottom: 1em; /* Bottom margin */
        resize: vertical /* Allow the user to vertically resize the textarea (not horizontally) */
    }

    /* Add a background color and some padding around the form */
    .contact_container {
        border-radius: 5px;
        background-color: #f2f2f2;
        padding: 20px;
    }
</style>

<section class="main style1 ">
    <header class="major" style="text-align: center">
        {{ section.content | safe}}
    </header>
    <div class="container contact_container">
        <form id="contact-form" class="pageclip-form" action="https://send.pageclip.co/xsgAwzGUPZLGLFaGYgXtzqLpxkxflZYh/contact-form" onsubmit="return false;" method="POST">
            <label for="inputName">Full Name</label>
                <input type="text" id="inputName" name="Name" placeholder="Firstname Lastname" required/>

            <label for="email">Email</label>
                <input type="email" id="email" name="Email" placeholder="example@mail.com" required/>

            <label for="message">Message</label>
                <textarea id="message" name="Message" style="height:200px" required></textarea>
            <input id="btnsubmit" type="submit" value="Submit" class="pageclip-form__submit" disabled/>
        </form>
        <div role="button" id="g-recaptcha" class="g-recaptcha" data-sitekey="6LcYFqsdAAAAAPBADsZ5-FZ4QxRz22HQbiKmIR31" data-expired-callback="onCaptchaExpire" data-callback="onCaptchaData"></div>
    </div>

</section>
<script type="text/javascript">
    function onCaptchaExpire(){
        document.getElementById("btnsubmit").disabled = true;
    }
    async function onCaptchaData(){
        try{
            await fetch('{{ config.extra.validation_server | safe}}', {
                method: 'POST',
                cache: 'no-cache',
                credentials: 'include',
                headers:{
                    'Content-Type':'application/json'
                },
                redirect: 'follow',
                referrerPolicy: 'no-referrer',
                body: JSON.stringify({public_key: document.getElementById('g-recaptcha').getAttribute('data-sitekey'), response: document.getElementById('g-recaptcha-response').value})
            }).then(response => {
                if(response.status === 200){
                    document.getElementById("btnsubmit").disabled = false;
                } else {
                    alert("An error occurred while validating the reCAPTCHA data. Please refresh and try agian.")
                }
            })
        } catch(err){
            console.log(err);
        }
    }
    // function submitForm(){
    //     document.getElementById("contact-form").submit();
    // }
    // document.getElementById("btnsubmit").onclick = function (){
    //     // var x = document.forms;
    //     // for(var i = 0; i < x.length; i++){
    //     //     if(x[i].value !== ""){
    //     //         return;
    //     //     }
    //     // }
    //     setTimeout("submitForm()", 3000);
    // }

    window.onload = function(){
        document.getElementById("contact-form").reset();
        document.getElementById("btnsubmit").disabled = true;
    }
</script>
{% endblock content %}


